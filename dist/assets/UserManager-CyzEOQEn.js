import{j as e}from"./ui-B79sv0Rh.js";import{r as s}from"./vendor-BefrSIwx.js";import{n as a,u as t,P as r,x as l,j as i,a2 as n,$ as d,y as c,a0 as o,G as h}from"./index-DpUjF_p5.js";import"./drei-Bucn9VWY.js";import"./three-DVpoEhjm.js";const m=[{key:"blogs",label:"Blogs"},{key:"events",label:"Events"},{key:"courses",label:"Courses"},{key:"projects",label:"Projects"},{key:"facilities",label:"Facilities"},{key:"users",label:"Users"},{key:"settings",label:"Settings"}],x=()=>{const[x,u]=s.useState([]),[p,j]=s.useState(!0),[y,g]=s.useState(""),[v,b]=s.useState({type:"",text:""}),[N,f]=s.useState({show:!1,action:null,user:null}),[k,C]=s.useState(null),[w,S]=s.useState("user"),[U,R]=s.useState([]);s.useEffect(()=>{A()},[]);const A=async()=>{try{const e=await a.get("/admin/users");u(e.data)}catch(e){P("error","Failed to load users")}finally{j(!1)}},P=(e,s)=>{b({type:e,text:s}),setTimeout(()=>b({type:"",text:""}),5e3)},E=x.filter(e=>e.name?.toLowerCase().includes(y.toLowerCase())||e.email?.toLowerCase().includes(y.toLowerCase())),$=e=>{switch(e){case"admin":return"status-badge published";case"editor":return"status-badge active";default:return"status-badge draft"}},B=e=>{switch(e){case"admin":return"ðŸ›¡ï¸";case"editor":return"âœï¸";default:return"ðŸ‘¤"}};return e.jsxs("div",{children:[e.jsxs("div",{className:"admin-header",children:[e.jsx("h1",{className:"admin-title",children:"User Management"}),e.jsxs("div",{style:{color:"var(--text-secondary)"},children:[x.length," total users"]})]}),v.text&&e.jsxs("div",{className:`settings-toast ${v.type}`,children:["success"===v.type?e.jsx(t,{}):e.jsx(r,{}),v.text]}),e.jsxs("div",{style:{marginBottom:24,position:"relative",maxWidth:400},children:[e.jsx(l,{style:{position:"absolute",left:16,top:"50%",transform:"translateY(-50%)",color:"var(--text-muted)"}}),e.jsx("input",{type:"text",placeholder:"Search users by name or email...",value:y,onChange:e=>g(e.target.value),style:{width:"100%",padding:"12px 16px 12px 44px",background:"var(--bg-secondary)",border:"1px solid var(--border-primary)",borderRadius:"var(--radius-md)",color:"var(--text-primary)"}})]}),e.jsxs("div",{className:"stats-grid",style:{marginBottom:24},children:[e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-icon",children:e.jsx(i,{})}),e.jsx("div",{className:"stat-value",children:x.length}),e.jsx("div",{className:"stat-label",children:"Total Users"})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-icon",style:{background:"rgba(0, 245, 160, 0.1)",color:"var(--accent-green)"},children:e.jsx(n,{})}),e.jsx("div",{className:"stat-value",children:x.filter(e=>"admin"===e.role).length}),e.jsx("div",{className:"stat-label",children:"Admins"})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-icon",style:{background:"rgba(123, 97, 255, 0.1)",color:"#7b61ff"},children:e.jsx(d,{})}),e.jsx("div",{className:"stat-value",children:x.filter(e=>"editor"===e.role).length}),e.jsx("div",{className:"stat-label",children:"Editors"})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-icon",style:{background:"rgba(255, 107, 53, 0.1)",color:"var(--accent-orange)"},children:e.jsx(c,{})}),e.jsx("div",{className:"stat-value",children:x.filter(e=>e.membership&&"None"!==e.membership).length}),e.jsx("div",{className:"stat-label",children:"Members"})]})]}),p?e.jsx("div",{className:"empty-state",children:"Loading users..."}):0===E.length?e.jsxs("div",{className:"empty-state",children:[e.jsx(i,{}),e.jsx("p",{children:"No users found"})]}):e.jsx("div",{className:"content-table-wrapper",children:e.jsxs("table",{className:"content-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"User"}),e.jsx("th",{children:"Email"}),e.jsx("th",{children:"Role"}),e.jsx("th",{children:"Permissions"}),e.jsx("th",{children:"Joined"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:E.map(s=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[e.jsx("div",{style:{width:36,height:36,borderRadius:"50%",background:"var(--accent-gradient)",display:"flex",alignItems:"center",justifyContent:"center",color:"var(--bg-primary)",fontWeight:600},children:s.name?.charAt(0).toUpperCase()||"U"}),e.jsx("span",{children:s.name})]})}),e.jsx("td",{children:e.jsx("a",{href:`mailto:${s.email}`,style:{color:"var(--accent-cyan)",textDecoration:"none"},children:s.email})}),e.jsx("td",{children:e.jsxs("span",{className:$(s.role),children:[B(s.role)," ",s.role?.charAt(0).toUpperCase()+s.role?.slice(1)]})}),e.jsx("td",{children:"editor"===s.role&&s.permissions?.length>0?e.jsx("div",{style:{display:"flex",gap:4,flexWrap:"wrap"},children:s.permissions.map(s=>e.jsx("span",{style:{fontSize:"0.75rem",padding:"2px 6px",background:"rgba(0, 229, 255, 0.1)",borderRadius:4,color:"var(--accent-cyan)"},children:s},s))}):"admin"===s.role?e.jsx("span",{style:{color:"var(--accent-green)",fontSize:"0.85rem"},children:"All"}):e.jsx("span",{style:{color:"var(--text-muted)",fontSize:"0.85rem"},children:"â€”"})}),e.jsx("td",{children:new Date(s.createdAt).toLocaleDateString()}),e.jsx("td",{children:e.jsxs("div",{className:"table-actions",children:[e.jsx("button",{className:"action-btn",title:"Edit Role & Permissions",onClick:()=>(e=>{C(e),S(e.role||"user"),R(e.permissions||[])})(s),children:e.jsx(d,{})}),e.jsx("button",{className:"action-btn delete",title:"Delete User",onClick:()=>f({show:!0,action:"delete",user:s}),children:e.jsx(o,{})})]})})]},s._id))})]})}),k&&e.jsx("div",{className:"modal-overlay",onClick:()=>C(null),children:e.jsxs("div",{className:"modal-content",onClick:e=>e.stopPropagation(),style:{maxWidth:500},children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h2",{className:"modal-title",children:"Edit Role & Permissions"}),e.jsx("button",{className:"modal-close",onClick:()=>C(null),children:e.jsx(h,{})})]}),e.jsxs("p",{style:{color:"var(--text-secondary)",marginBottom:20},children:["Editing: ",e.jsx("strong",{children:k.name})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Role"}),e.jsx("div",{style:{display:"flex",gap:12},children:["user","editor","admin"].map(s=>e.jsxs("button",{type:"button",onClick:()=>S(s),style:{flex:1,padding:"12px",background:w===s?"var(--accent-gradient)":"var(--bg-secondary)",border:"1px solid "+(w===s?"transparent":"var(--border-primary)"),borderRadius:"var(--radius-md)",color:w===s?"var(--bg-primary)":"var(--text-primary)",cursor:"pointer",fontWeight:w===s?600:400},children:[B(s)," ",s.charAt(0).toUpperCase()+s.slice(1)]},s))})]}),"editor"===w&&e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Permissions"}),e.jsx("p",{style:{fontSize:"0.85rem",color:"var(--text-muted)",marginBottom:12},children:"Select which sections this editor can manage:"}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:8},children:m.map(s=>e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:6,padding:"10px 12px",background:U.includes(s.key)?"rgba(0, 229, 255, 0.1)":"var(--bg-secondary)",border:"1px solid "+(U.includes(s.key)?"var(--accent-cyan)":"var(--border-primary)"),borderRadius:"var(--radius-md)",cursor:"pointer",whiteSpace:"nowrap"},children:[e.jsx("input",{type:"checkbox",checked:U.includes(s.key),onChange:()=>{return e=s.key,void R(s=>s.includes(e)?s.filter(s=>s!==e):[...s,e]);var e},style:{accentColor:"var(--accent-cyan)",width:18,height:18,cursor:"pointer"}}),s.label]},s.key))})]}),e.jsxs("div",{style:{display:"flex",gap:12,marginTop:24},children:[e.jsx("button",{className:"btn btn-primary",onClick:async()=>{try{await a.put(`/admin/users/${k._id}/role`,{role:w,permissions:"editor"===w?U:[]}),P("success",`${k.name}'s role updated successfully`),A(),C(null)}catch(e){P("error",e.response?.data?.message||"Failed to update role")}},disabled:"editor"===w&&0===U.length,children:"Save Changes"}),e.jsx("button",{className:"btn btn-secondary",onClick:()=>C(null),children:"Cancel"})]})]})}),N.show&&e.jsx("div",{className:"modal-overlay",onClick:()=>f({show:!1,action:null,user:null}),children:e.jsxs("div",{className:"modal-content",onClick:e=>e.stopPropagation(),style:{maxWidth:400},children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h2",{className:"modal-title",children:"Delete User?"}),e.jsx("button",{className:"modal-close",onClick:()=>f({show:!1,action:null,user:null}),children:e.jsx(h,{})})]}),e.jsxs("p",{style:{color:"var(--text-secondary)",marginBottom:24},children:["Are you sure you want to delete ",e.jsx("strong",{children:N.user?.name}),"? This action cannot be undone."]}),e.jsxs("div",{style:{display:"flex",gap:12},children:[e.jsx("button",{className:"btn btn-danger",onClick:()=>(async e=>{try{await a.delete(`/admin/users/${e._id}`),P("success",`User ${e.name} has been deleted`),A()}catch(s){P("error",s.response?.data?.message||"Failed to delete user")}f({show:!1,action:null,user:null})})(N.user),children:"Delete"}),e.jsx("button",{className:"btn btn-secondary",onClick:()=>f({show:!1,action:null,user:null}),children:"Cancel"})]})]})})]})};export{x as default};
//# sourceMappingURL=UserManager-CyzEOQEn.js.map
